<html>
<head>
    <title>Pick an image to upload and crop</title>
    <link href="/assets/vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <link href="/assets/vendor/cropperjs/dist/cropper.min.css" rel="stylesheet">
    <link href="/assets/vendor/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/image_upload.css" rel="stylesheet">
</head>

<body>
<header class="header">
    <div class="menu_left">
        <a id="btn-move" data-action="clear" title="Move" class="menu_button">
            <span class="fa fa-arrows"></span>
            <span hidden aria-hidden="false">Move</span>
        </a>

        <a id="btn-drag" data-action="clear" title="Crop" class="menu_button">
            <span class="fa fa-crop"></span>
            <span hidden aria-hidden="false">Crop</span>
        </a>

        <a href="javascript:void(0)" target="_blank" class="menu_result" id="result-url"></a>
    </div>

    <div class="menu">
        <label for="file" title="Upload" class="menu_button">
            <span class="fa fa-upload" aria-hidden="true"></span>
            <span hidden aria-hidden="false">Upload</span>
        </label>
        <a data-action="clear" title="Cancel" class="menu_button">
            <span class="fa fa-ban" aria-hidden="true"></span>
            <span hidden aria-hidden="false">Cancel</span>
        </a>
        <a id="btn-accept" data-action="crop" title="Accept" class="menu_button">
            <span class="fa fa-check" aria-hidden="true"></span>
            <span hidden aria-hidden="false">Accept</span>
        </a>

        <input id="file" type="file" accept="image/*" class="sr-only">
    </div>
</header>

<div class="image_container">
    <img id="image" style="display: none;">
</div>
<!--<script src="/assets/vendor/bootstrap/dist/js/bootstrap.min.js"></script>-->
<script type="text/javascript" src="/assets/vendor/jquery/dist/jquery.js"></script>
<script type="text/javascript" src="/assets/vendor/cropperjs/dist/cropper.min.js"></script>
<script type="text/javascript" src="/js/image_upload.js"></script>
<script type="text/javascript">
  $(function () {
    var imageUpload = new ImageUpload({{ aspectRatio }}, '{{ tokenId }}', '{{ backUrl }}')
    var $resultUrl = $('#result-url')

    $('#btn-move').on('click', function (e) {
      e.preventDefault()
      imageUpload.changeMode('move')
    })

    $('#btn-drag').on('click', function (e) {
      e.preventDefault()
      imageUpload.changeMode('drag')
    })

    $('#btn-accept').on('click', function (e) {
      e.preventDefault()

      imageUpload.accept(function (fileUrl) {
        $resultUrl.html('<span class="fa fa-file-image-o" aria-hidden="true"></span> ' + fileUrl)
        $resultUrl.attr('href', fileUrl)
      })
    })

    $('#file').on('change', imageUpload.handleImageUpload)
  })
</script>
</body>
</html>
